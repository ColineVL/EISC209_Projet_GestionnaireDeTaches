{% extends "base.html" %}
{% block title %}Task{% endblock %}
{% load bootstrap4 %}


{% block nav %}
    <ul class="nav">
        <li class="nav-item">
            <a class="nav-link" href={% url "projects" %}>Projets</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'project' task.project.id %}">{{ task.project }}</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'task' task.id %}">{{ task }}</a>
        </li>
    </ul>
{% endblock %}


{% block content %}

    <div class="container">
        <a href={% url "edittask" task.id %}>
            <i class="fa fa-pencil-square-o fa-3x close text-primary" aria-hidden="true"></i>
        </a>
        <h2>{{ task.project }}</h2>
        <h4>{{ task }}</h4>
        <p>{{ task.description }}</p>

    </div>

    <div class="container">
        <table class="table">
            <tr>
                <th>Assignée</th>
                <td><span class="badge badge-primary">{{ task.assignee }}</span></td>
            </tr>
            <tr>
                <th>Start date</th>
                <td><i>{{ task.start_date|date:"SHORT_DATE_FORMAT" }}</i></td>
            </tr>
            <tr>
                <th>Due date</th>
                <td><i>{{ task.due_date|date:"SHORT_DATE_FORMAT" }}</i></td>
            </tr>
            <tr>
                <th>Priority</th>
                <td>{{ task.priority }}</td>
            </tr>
            <tr>
                <th>Status</th>
                <td><span class="badge badge-warning">{{ task.status }}</span></td>
            </tr>
        </table>

    </div>

    <div class="container">
        <h6>History</h6>
        {% if liste_journal %}
            <table class="table">
                {% for info in liste_journal %}
                <tr>
                    <td>
                        <span class="badge badge-primary">{{ info.author }}</span>
                        <i>{{ info.date|date:"SHORT_DATETIME_FORMAT" }}</i>
                    </td>
                    <td>{{ info.entry }}</td>
                </tr>
            </table>
        {% else %}
            <p>Il n'y a pas d'entrée dans le journal...</p>
        {% endif %}
    </div>

    <div class="container">
        <button type="button" class="btn btn-primary" data-toggle="collapse" data-target="#newentry">New entry
        </button>
        <div id="newentry" class="collapse">
            <form action="{% url "task" task.id %}" method="post">
                {% csrf_token %}
                <br>
                {% bootstrap_field form.entry show_label=False addon_before='<i class="fa fa-pencil" aria-hidden="true"></i>' %}
                {% buttons %}
                    <button type="submit" class="btn btn-primary">Send</button>
                {% endbuttons %}
            </form>
        </div>
    </div>

{% endblock %}

